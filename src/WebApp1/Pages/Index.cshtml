@page
@model IndexModel
@{
    ViewData["Title"] = "Home";
}

<div class="row mb-auto">
    <div class="col-md-4">
        <div class="row no-gutters border mb-4">
            <div class="col p-4 mb-4 ">
                <p class="card-text">
                    PCR2 PoC is a sample application that
                    demonstrates how to use Entity Framework Core in an
                    ASP.NET Core Razor Pages web app and an Azure Function App.
                    Users access (through internal network & public internet) is done through a locked down Application Gateway.
                    Function Apps function access the internet through VNet integration with a NAT Gateway (so the Public IP is known and constant for IP filtering).
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="row no-gutters border mb-4">
            <div class="col p-4 d-flex flex-column position-static">
                <p class="card-text mb-auto">
                    It uses a Windows App Service, Private endpoints, Private DNS Zones, Managed Identity to connect to Storage Accounts and Azure SQL Database. For authentication, it uses the App Service authentication provider, linked to Azure AD with user.read permission on the Graph API.
                </p>
                <p>
                    @*                    <a href="https://docs.microsoft.com/aspnet/core/data/ef-rp/intro" class="stretched-link">See the tutorial</a>
*@                </p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="row no-gutters border mb-4">
            <div class="col p-4 d-flex flex-column">
                <p class="card-text mb-auto">
                    It also uses a Function App to process files, a NAT Gateway for outbound access to the public internet through a known/defined Public IP, an Anomaly Detector for data series anomaly detection, required DNS records for SCM/management-deployment into App Service and Function App from Visual Studio and an Azure DevOps Pipeline.
                </p>
                <p>
                    @*                    <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" class="stretched-link">See project source code</a>
*@                </p>
            </div>
        </div>
    </div>
</div>
<div class="row mb-auto">
    @if (User.Identity?.IsAuthenticated == true)
    {
    <div class="row mb-auto">
        <p>Client IP: @Model.RemoteIp, Scheme: @Model.Scheme,</p>
        <p>Host header: @Model.HostHeader,</p>
        <p>X-Forwarded-For: @Model.XForwardedFor,</p>
@*         <p>X-Coming-From: @Model.XComingFrom,</p>
 *@        <p>Server IP: @Model.LocalIp, Host: @Model.Host.</p>
    </div>
    }
</div>
